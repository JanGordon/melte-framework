(()=>{var m=(c,n)=>()=>(n||c((n={exports:{}}).exports,n),n.exports);var g=m((exports,module)=>{var caches={};async function cacheAllLinks(){var c=Array.from(document.querySelectorAll("a"));console.log("caching new links...",c);for(let u of c){console.log(u);var n=u;let l=new URL(n.href);if(window.location.origin!=l.origin){console.log("passing this link: not on same origin");continue}await fetch(l).then(function(o){return o.text()}).then(function(o){caches[l]=o}).catch(o=>{console.log("Failed to fetch link")}),u.addEventListener("click",async function(o){if(o.preventDefault(),caches.hasOwnProperty(n)){let a=new URL(n.href);var s=caches[a];let i=Range.prototype.createContextualFragment.bind(document.createRange());var t=document.implementation.createHTMLDocument();t.documentElement.innerHTML=s,console.log("Loading cached page",s),document.body.innerHTML=t.body.innerHTML,console.log(t.head.innerHTML),document.head.querySelectorAll("*:not(script)").forEach(function(e){e.remove()}),t.head.querySelectorAll("*:not(script").forEach(function(e){document.head.appendChild(e)}),history.replaceState({},t.title,n.href);var r="";t.querySelectorAll("script[ssr='']").forEach(function(e){e.innerText.charAt(e.innerText.length-1)==";"?r+=e.innerText:r+=e.innerText+`
`}),t.querySelectorAll("melte-reload").forEach(function(e){e.getAttribute("js")!=""?(r+="",console.log("Preloaded responsive html")):console.log("melte-reload js field empty")}),Function(r)(),document.body.querySelectorAll("script").forEach(function(e){if(e.src.includes("out.js")){var d=new URL(e.src.slice(0,e.src.indexOf("out.js"))),f=document.createElement("script");e.parentNode.appendChild(f),e.remove(),f.src=d.pathname+"out.js?cachebuster="+new Date().getTime(),console.log(d.pathname+"out.js?cachebuster="+new Date().getTime())}}),cacheAllLinks()}else setTimeout(()=>{console.log("Page hasn't been cached, loading...")},1e3),await fetch(l).then(function(a){return a.text()}).then(function(a){caches[l]=a;var i=document.implementation.createHTMLDocument();i.documentElement.innerHTML=s,document.body.innerHTML=i.body.innerHTML,history.replaceState({},i.title,n.href),cacheAllLinks()}).catch(()=>{console.log("Failed to fetch link")});var h="hello";console.log(h);var h="hello";function y(){}})}}Array(document.querySelectorAll("a")).forEach(function(c,n){});function makeEvalContext(declarations){return eval(declarations),function(str){eval(str)}}window.addEventListener("popstate",cacheAllLinks);cacheAllLinks()});g();})();
